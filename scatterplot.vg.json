{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "title": "Incidence vs Mortality by Cancer Type (Persons, All ages, 2025)",
  "width": 860,
  "height": 520,
  "data": { "url": "incident_to_mortality.csv" },
  "transform": [
    { "calculate": "toNumber(datum.Year)", "as": "Year_num" },
    { "filter": "datum.Year_num == 2025" },
    { "filter": "datum.Sex === 'Persons'" },
    { "filter": "datum.Age_group === 'All ages combined'" },

    {
      "calculate": "isValid(datum['Cancer_types']) ? trim(datum['Cancer_types']+'') : trim(datum['\uFEFFCancer_types']+'')",
      "as": "Cancer"
    },

    { "calculate": "toNumber(replace(datum['Incident_count'], ',', ''))", "as": "incidents" },
    { "calculate": "toNumber(replace(datum['Mortality_counts'], ',', ''))", "as": "deaths" },
    { "calculate": "toNumber(datum['Age-specific incident rate\\n(cases per 100,000)'])", "as": "inc_rate" },
    { "calculate": "toNumber(datum['Age-specific mortality rate\\n(cases per 100,000)'])", "as": "mort_rate" },

    { "filter": "isValid(datum.inc_rate) && isValid(datum.mort_rate) && isValid(datum.Cancer)" }
  ],
  "mark": { "type": "circle", "opacity": 0.8, "tooltip": true },
  "encoding": {
    "x": { "field": "inc_rate", "type": "quantitative", "title": "Age-specific incidence rate (per 100,000)" },
    "y": { "field": "mort_rate", "type": "quantitative", "title": "Age-specific mortality rate (per 100,000)" },
    "size": { "field": "incidents", "type": "quantitative", "title": "Incident cases", "legend": { "orient": "right" }, "scale": {"type": "threshold","domain": [500, 1000, 2000, 5000, 8000, 11000, 14000, 17000, 20000, 23000, 26000],"range": [10, 50, 150, 200, 300, 400]} },
    "color": { "field": "Cancer", "type": "nominal", "title": "Cancer type" },
    "tooltip": [
      { "field": "Cancer", "type": "nominal", "title": "Cancer" },
      { "field": "incidents", "type": "quantitative", "title": "Incidents" },
      { "field": "deaths", "type": "quantitative", "title": "Deaths" },
      { "field": "inc_rate", "type": "quantitative", "title": "Incidence rate" },
      { "field": "mort_rate", "type": "quantitative", "title": "Mortality rate" }
    ]
  },
  "config": { "view": { "stroke": null }, "axis": { "grid": true } }
}
